# ç®€å•è€Œå¤æ‚çš„æ’åºç®—æ³•

ç›®å‰å¸‚é¢ä¸Šå¸¸è§çš„æ’åºç®—æ³•ä¸»è¦æœ‰ä¸¤ç§ï¼š

- $O(n^2)$ï¼šé€‰æ‹©æ’åºï¼Œå†’æ³¡æ’åºï¼Œæ’å…¥æ’åºã€å¸Œå°”æ’åºï¼ˆæœ‰æ—¶èƒ½$nlogn$ï¼‰
- $O(nlogn)$ï¼šå¿«é€Ÿæ’åºã€å½’å¹¶æ’åºã€å †æ’åºã€
- $O(n+k)$ï¼šè®¡æ•°æ’åºã€æ¡¶æ’åº
- $O(n*k)$ï¼šåŸºæ•°æ’åº

ç®—æ³•ä¼˜åŒ–å¾€å¾€ä¸æ’åºæ€æƒ³ä¸€ç‚¹è€Œé€šï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»åå¤§æ’åºç®—æ³•ï¼Œå¹¶å¯¹å…¶ä¸­ä¸€äº›ç»å…¸æ’åºç®—æ³•ä¼˜åŒ–

# $O(n^2)$ç®—æ³•

> é€‰æ‹©ã€å†’æ³¡ã€æ’å…¥æ˜¯æ—¶é—´å¤æ‚åº¦ä¸º$O(n^2)$çš„ç®—æ³•

## é€‰æ‹©æ’åºâ€”â€”æ’åºä¹‹æº

### åŸå§‹é€‰æ‹©æ’åº

æ ¸å¿ƒæ€æƒ³ï¼šåœ¨ä¸€ç»„æ•°æ®ä¸­ï¼Œæ¯æ¬¡é€‰æ‹©ä¸€ä¸ªæœ€å°å€¼æ”¾åˆ°æ•°ç»„æœ€å‰è¾¹

ç‰¹ç‚¹ï¼š

- ç®€å•
- æ•ˆç‡ä½ä¸‹

```java
public void selectSort(Integer[] arr) {
        int n = arr.length;
        for (int i = 0; i < n; i++) {
            /*åˆå§‹åŒ–minIndexæŒ‡å‘i*/
            int minIndex = i;
            /*å¾ªç¯ä¸å˜é‡->[i+1,n)æ‰¾åˆ°æœ€å°å€¼çš„ç´¢å¼•ï¼Œiæœ€ç»ˆæŒ‡å‘æœ€å°å€¼*/
            for (int j = i + 1; j < n; j++) {
                if (arr[minIndex] > arr[j]) {
                    minIndex = j;
                }
            }
            Community.swap(arr, i, minIndex);
        }
    }
```

### ä¼˜åŒ–

ä¼˜åŒ–æ ¸å¿ƒæ€æƒ³ï¼šæ¯ä¸€è½®æ‰¾åˆ°å½“å‰æœªå¤„ç†å…ƒç´ çš„æœ€å¤§å€¼å’Œæœ€å°å€¼

```java
public void selectSortOptimization(Integer[] arr) {
        /*
        l,ræŒ‡å‘arrçš„å·¦å³ä¸¤è¾¹ï¼ˆæœ€å¤§ã€æœ€å°å€¼è¯¥å¡«å……çš„ä½ç½®ï¼‰
        min,maxåˆ†åˆ«æŒ‡å‘æœ€æœªæ£€æŸ¥å…ƒç´ çš„æœ€å¤§å€¼ç´¢å¼•å’Œæœ€å°å€¼ç´¢å¼•
        */
        int l = 0;
        int r = arr.length - 1;
        while (l <= r) {
            int minIndex = l;
            int maxIndex = r;
            /*æ¯ä¸€è½®æŸ¥è¯¢ä¿è¯arr[maxIndex]>=arr[minIndex]*/
            if (arr[maxIndex] < arr[minIndex]) {
                Community.swap(arr, maxIndex, minIndex);
            }
            /*å¾ªç¯ä¸å˜é‡ï¼š
            l,rçš„ä½ç½®ä¸å˜ï¼šæŒ‡å‘æœ€å°ã€æœ€å¤§å€¼åº”è¯¥æ’å…¥çš„ä½ç½®
            maxIndexã€minIndexå«ä¹‰ä¸å¿…æ‹¿ï¼šæ‰¾åˆ°æœ€å°æœ€å¤§å€¼å¯¹åº”çš„ç´¢å¼•*/
            for (int i = l + 1; i < r; i++) {
                if (arr[i] > arr[maxIndex]) {
                    maxIndex = i;
                }
                if (arr[i] < arr[minIndex]) {
                    minIndex = i;
                }
            }
            /*äº¤æ¢ä½ç½®*/
            if (minIndex != l) {
                Community.swap(arr, minIndex, l);
            }
            if (maxIndex != l) {
                Community.swap(arr, maxIndex, r);
            }
            /*å‰è¿›*/
            l++;
            r--;
        }
```

æ¯æ¬¡æ‰¾åˆ°æœªæ£€ç´¢åŒºåŸŸçš„æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œå¹¶ä¸æŒ‡é’ˆæŒ‡å‘çš„æ•°ç»„ä½ç½®äº¤æ¢

## å†’æ³¡æ’åºâ€”â€”åˆ†è§’è§’é€

æ ¸å¿ƒæ€æƒ³ï¼šé¡ºåºæ€§çš„ä¸¤ä¸¤æ¯”è¾ƒï¼Œç›¸äº’è§’é€ï¼Œæ¯è½®è§’é€å‡ºæœ€å¤§çš„å€¼ï¼Œ**å°±åƒæ˜¯å†’æ³¡ä¸€æ ·**

```java
public void bubbleSort(Integer[] arr) {
        int n = arr.length - 1;
        /*n-1è½®å³å¯ï¼Œæœ€åä¸€æ¬¡ä¸éœ€è¦å†’æ³¡*/
        for (int i = 0; i < n - 1; i++) {
            for (int j = 1; j < n - i; j++) {
                if (arr[j] < arr[j - 1]) {
                    Community.swap(arr, j, j - 1);
                }
            }
        }
    }
```

### å†’æ³¡æ’åºä¼˜åŒ–

- é‡‡ç”¨æ ‡å¿—ä½æå‰ä¸­æ­¢å†’æ³¡æ’åº
- æ¯æ¬¡ä»…è€ƒè™‘æœªæ’å¥½åºçš„éƒ¨åˆ†

```java
public void bubbleSortOptimization(Integer[] arr) {
        int n = arr.length - 1;
        while (true) {
            /*newNè®°å½•æœ€è¿‘ä¸€æ¬¡åº”è¯¥å†’æ³¡çš„ä½ç½®*/
            int newN = 0;
            boolean isSwap = false;
            for (int i = 1; i <= n; i++) {
                if (arr[i] < arr[i - 1]) {
                    Community.swap(arr, i, i - 1);
                    isSwap = true;
                    newN = i;
                }
            }
            /*newNä¹‹åä¸è€ƒè™‘å†’æ³¡äº†*/
            n = newN;
            /*æ²¡æœ‰å†’æ³¡å°±ä¸­æ­¢å¾ªç¯*/
            if (!isSwap) {
                break;
            }
        }
    }
```

## æ’å…¥æ’åºâ€”â€”æˆ‘æ˜¯èµŒç‹

æ ¸å¿ƒæ€æƒ³ï¼šæ’å…¥æ’åºå°±åƒæ˜¯èµŒç‹æ•´ç†æ‰‘å…‹ç‰Œä¸€æ ·ï¼Œæ¯æ¬¡æŠŠä¸€ä¸ªæ•°æ”¾åˆ°åº”è¯¥æ’å…¥çš„åœ°æ–¹

```java
public void insertSort(Integer[] arr) {
        int n = arr.length;
        for (int i = 1; i < n; i++) {
            /*jä»i-1å¼€å§‹ï¼Œæ‰¾içš„ä½ç½®*/
            for (int j = i; j > 0; j--) {
                if (arr[j - 1] > arr[j]) {
                    Community.swap(arr, j, j - 1);
                }else {
                    /*ä¹‹å‰çš„éƒ½æ˜¯æœ‰åºçš„ï¼Œä¸€ç›´æ‰¾åˆ°iåº”è¯¥æ’å…¥çš„ä½ç½®ï¼Œå°±æ²¡æœ‰æ’å…¥æ’åºçš„å¿…è¦äº†*/
                    break;
                }
            }
        }
    }
```

å®ç°æ–¹å¼ï¼š

- å¾ªç¯ä¸å˜é‡ï¼šçº¦å®šjä¸æ–­é è¿‘iåº”è¯¥æ’å…¥çš„ä½ç½®(ä¸€æ­¥ä¸€æ­¥çš„)
- æ‰¾åˆ°å³å¯é€€å‡ºæ­¤æ¬¡å¾ªç¯

### æ’å…¥æ’åºä¼˜åŒ–

æ ¸å¿ƒæ€æƒ³ï¼šswapè¿™ä¸ªæ“ä½œå¤ªè´¹æ—¶å•¦ï¼Œå¯ä»¥å­˜å‚¨ä¸€ä»½å½“å‰å€¼arr[j]ï¼Œç„¶åarr[j-1]ä¹‹å‰çš„å€¼å…¨éƒ¨å¾€åè¦†ç›–ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥æ’å…¥çš„ä½ç½®

```java
public void insertSortAlgorithm(Integer[] arr) {
        int n = arr.length;
        for (int i = 1; i < n; i++) {
            /*å¤‡ä»½arr[i]*/
            int temp = arr[i];
            for (int j = i; j > 0; j--) {
                if (temp < arr[j - 1]) {
                    arr[j] = arr[j - 1];
                } else {
                    /*jä¾ç„¶æ˜¯tempè¯¥æ’å…¥çš„ä½ç½®*/
                    arr[j] = temp;
                    break;
                }
            }
        }
    }
```

## å¸Œå°”æ’åºâ€”â€”æˆ‘æ˜¯æ›´ç‰›é€¼çš„æ’å…¥æ’åº

æ ¸å¿ƒæ€æƒ³ï¼šå¤šè·¯æ’å…¥æ’åºï¼Œå°†æ’å…¥æ’åºæŠ½æ ·ä¸ºå¤šä¸ªå­åºåˆ—ï¼Œç„¶åå¯¹å„ä¸ªå­åºåˆ—æ’å…¥æ’åºï¼Œä½¿å¾—æ•°æ®è¶Šæ¥è¶Šè¶‹è¿‘æœ‰åºåŒ–ã€‚

```java
public void shellSort(Integer[] arr) {
        int n = arr.length;
        /*æŠ½æ ·ç‡ï¼Œæ¯æ¬¡æŠ½æ ·çš„é—´éš”*/
        int gap = n / 2;
        while (gap > 0) {
            /*æ‰¾åˆ°æ¯ä¸ªå°ç»„çš„æœ€åä¸€ä¸ªç›®æ ‡ï¼Œå¯¹å…¶æ’å…¥æ’åº*/
            for (int i = gap; i < n; i++) {
                /*æ’å…¥æ’åºå¼€å§‹äº†*/
                int j = i;
                int temp = arr[i];
                while (j - gap >= 0 && temp < arr[j - gap]) {
                    arr[j] = arr[j - gap];
                    j -= gap;
                }
                arr[j] = temp;
            }
            gap /= 2;
        }
    }
```



## $O(n^2)$ç®—æ³•ç‰¹æ€§è¯´æ˜

| ç®—æ³•     | ä¼˜ç‚¹                                                     | ç¼ºç‚¹                           |
| -------- | -------------------------------------------------------- | ------------------------------ |
| é€‰æ‹©æ’åº | ç®€å•                                                     | ä½æ•ˆç‡ï¼Œæ— è®ºæ€æ ·éƒ½éœ€è¦ä¸¤æ¬¡éå† |
| å†’æ³¡æ’åº | æ¯”é€‰æ‹©æ’åºæ•ˆç‡é«˜                                         | æ¯”æ’å…¥æ’åºæ…¢                   |
| æ’å…¥æ’åº | **å¯¹è¿‘ä¹æœ‰åºçš„æ•°ç»„æ’åºæ€§èƒ½å¥½**ï¼Œç”šè‡³æ¯”$O(nlogn)$çš„ç®—æ³•å— | æ— åºçš„æ•ˆç‡ä¸å¦‚$O(nlogn)$æ—     |

# $O(nlogn)$ç®—æ³•

## å¿«é€Ÿæ’åºâ€”â€”æœ€ä¼Ÿå¤§çš„å‘æ˜

- æ ¸å¿ƒæ€æƒ³ï¼šé€’å½’ï¼Œå…ˆå¤§èŒƒå›´æ’åºï¼Œé€æ¸ç¼©å°åŒ…å›´åœˆ
- é‡è¦åŸºçŸ³ï¼š**partition**ï¼Œæœ€æœ€æœ€é‡è¦çš„å®ç°

```java
public void quickSort(Integer[] arr) {
        int n = arr.length;
        /*[0,n-1]å¿«é€Ÿæ’åº*/
        quickSort(arr, 0, n - 1);
    }

    /**
     * @param arr arr
     * @param l   å·¦è¾¹ç•Œ
     * @param r   å³è¾¹ç•Œ
     */
    private void quickSort(Integer[] arr, int l, int r) {
        /*é€’å½’ä¸­æ­¢æ¡ä»¶*/
        if (l >= r) {
            return;
        }

        int p = partition(arr, l, r);
        quickSort(arr, l, p - 1);
        quickSort(arr, p + 1, r);
    }

    /**
     * @param arr arr[l,r]
     * @param l   left
     * @param r   right
     * @return p
     */
    private int partition(Integer[] arr, int l, int r) {
        int p = arr[l];
        int j = l;
        /*
         * arr[l+1,j]<p,arr[j+1,i-1]>=p
         * jæŒ‡å‘å°äºPçš„æœ€åä¸€ä¸ªæ•°*/
        for (int i = l + 1; i <= r; i++) {
            if (arr[i] < p) {
                /*æ‰¾åˆ°æ¯”På°çš„æ•°ï¼ŒJæŒªåŠ¨ä¸€ä½ï¼Œç„¶åäº¤æ¢ä½ç½®*/
                j++;
                Community.swap(arr, i, j);
            }
        }
        Community.swap(arr, l, j);
        return j;
    }
```

### ä¼˜åŒ–ä¸€ï¼šä½¿ç”¨æ’å…¥æ’åºä¼˜åŒ–å¿«æ’

- è¿‘ä¹æœ‰åºï¼ˆæ•°ç»„è¾ƒå°ï¼‰çš„æƒ…å†µä¸‹ï¼Œæ’å…¥æ’åºæ¯”å¿«æ’æ•ˆç‡é«˜
- å½“$r-l <= 15$ï¼Œé€‰ç”¨æ’å…¥æ’åº

```java
private void quickSortOptimizationOne(Integer[] arr, int l, int r) {
        if (r - l <= 15) {
            new InsertSort().insertSortOptimization(arr);
            return;
        }
        int p = partition(arr, l, r);
        quickSort(arr, l, p - 1);
        quickSort(arr, p + 1, r);

    }
```

### ä¼˜åŒ–äºŒï¼šéšæœºå¿«æ’

- å¯¹äºå¤§çš„è¿‘ä¹æœ‰åºçš„æ•°ç»„ï¼ŒåŸå§‹å¿«æ’æ€§èƒ½éå¸¸å·®ï¼Œå› ä¸ºå®ƒé€‰æ‹©ç¬¬ä¸€ä¸ªä½ç½®çš„æ•°å­—ï¼ˆè¿‘ä¹æœ€å°çš„æ•°å­—ï¼‰ï¼Œéå¸¸ä¸å‡è¡¡ï¼ˆ**å¿«æ’ï¼Œå¿«å¾—å°±æ˜¯æŠŠæ•°ç»„åˆ†æˆä¸¤ä¸ªè¿‘ä¼¼ç›¸åŒé‡çº§çš„æ•°ç»„æ’åºï¼Œæœ‰ç‚¹ç±»ä¼¼äºäºŒåˆ†æŸ¥æ‰¾çš„æ„Ÿè§‰**ï¼‰

- æ”¹è¿›æ ¸å¿ƒæ€æƒ³ï¼špå€¼éšæœºé€‰æ‹©ï¼Œä¸é€‰å–æœ€å·¦è¾¹çš„å…ƒç´ 

```java
private int partitionOptimizationOne(Integer[] arr, int l, int r) {
        /*éšæœºé€‰å–åè¾¹ä¸€ä¸ªæ•°ï¼Œä¸läº¤æ¢*/
        Community.swap(arr, l, (int) (Math.random() * (r - l + 1)) + l);
        int p = arr[l];
        int j = l;
        /*
         * arr[l+1,j]<p,arr[j+1,i-1]>=p
         * jæŒ‡å‘å°äºPçš„æœ€åä¸€ä¸ªæ•°*/
        for (int i = l + 1; i <= r; i++) {
            if (arr[i] < p) {
                /*æ‰¾åˆ°æ¯”På°çš„æ•°ï¼ŒJæŒªåŠ¨ä¸€ä½ï¼Œç„¶åäº¤æ¢ä½ç½®*/
                j++;
                Community.swap(arr, i, j);
            }
        }
        Community.swap(arr, l, j);
        return j;
    }
```

### ä¼˜åŒ–ä¸‰ï¼šåŒè·¯å¿«æ’

- ä¸Šè¿°æ’åºçš„ç¼ºç‚¹ï¼šå¯¹äºæ•°å­—é‡å åº¦é«˜çš„æ•°ç»„ï¼Œæ’åºæ•ˆç‡ä½ï¼ˆåŸå› ï¼šé‡å åº¦é«˜çš„æ•°å­—ä¼šä½¿æ‹†åˆ†çš„æ•°ç»„åˆ†å¸ƒä¸å‡ï¼‰
- è§£å†³æ–¹æ³•åŒè·¯å¿«æ’æˆ–è€…ä¸‰è·¯å¿«æ’

![image-20200306091515149](https://tva1.sinaimg.cn/large/00831rSTly1gcl6pradqcj30xw0c375f.jpg)

æ ¸å¿ƒæ€æƒ³ï¼ˆ@æ³¢æ³¢è€å¸ˆçš„æ€è·¯ï¼‰ï¼š

![image-20200306091742215](https://tva1.sinaimg.cn/large/00831rSTly1gcl6prsc2gj30wf08ugmx.jpg)

```java
private int partitionOptimizationTwo(Integer[] arr, int l, int r) {
        /*éšæœºé€‰å–åè¾¹ä¸€ä¸ªæ•°ï¼Œä¸läº¤æ¢*/
        Community.swap(arr, l, (int) (Math.random() * (r - l + 1)) + l);
        int p = arr[l];
        int i = l + 1;
        int j = r;
        /*
         * å¾ªç¯ä¸å˜é‡ï¼š[l+1,i-1]<=P [j+1,r]>=P
         * */
        while (true) {
            /* arr[i]<p é˜²æ­¢è¿ç»­å‡ºç°çš„æ•°å­—å½’åœ¨ä¸€æ–¹*/
            while (i <= r && arr[i] < p) {
                i++;
            }
            while ((j >= 0 && arr[j] > p)) {
                j--;
            }
            /*æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦è¿‡ç•Œ*/
            if(i>j){
                break;
            }
            /*æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸ç¬¦åˆæ¡ä»¶çš„ä¸¤ä¸ªä½ç½®*/
            Community.swap(arr,i,j);
            j--;
            i++;

        }
        /*æœ€åäº¤æ¢ç›®æ ‡åˆ°æœŸåº”è¯¥åˆ°çš„ä½ç½®*/
        Community.swap(arr,l,i);
        return i;
    }
```

### ä¼˜åŒ–å››ï¼šä¸‰è·¯å¿«æ’

- æ ¸å¿ƒæ€æƒ³ï¼šè®¾ç½®ltã€gtæŒ‡é’ˆï¼Œåˆ†åˆ«æŒ‡å‘å°äºç›®æ ‡å’Œå¤§äºç›®æ ‡çš„æœ€åä¸€ä¸ªå€¼ï¼Œè€Œ[lt,i-1]æŒ‡å‘ç­‰äºç›®æ ‡çš„å€¼

```java
public void quickSort3Ways(Integer[] arr, int l, int r) {
        if(r-l<=15){
            new InsertSort().insertSortOptimization(arr);
            return;
        }
        /*éšæœºé€‰å–åè¾¹ä¸€ä¸ªæ•°ï¼Œä¸läº¤æ¢*/
        Community.swap(arr, l, (int) (Math.random() * (r - l + 1)) + l);
        int p = arr[l];
        /*lt [l+1,lt]<p
         * gt [gt,r]>p*/
        int lt = l;
        int gt = r + 1;
        /*
         * å¾ªç¯ä¸å˜é‡ï¼š[lt+1,i-1]=p
         * */
        int i = l + 1;
        while (i < gt) {
            if (arr[i] > p) {
              //æ­¤æ—¶ä¸éœ€è¦æ›´æ–°içš„å€¼ç”±äºï¼Œgtçš„å€¼è¿˜æ²¡æ£€æµ‹
                gt--;
                Community.swap(arr, i, gt);
            } else if (arr[i] < p) {
                lt++;
                Community.swap(arr, lt, i);
              //æ­¤æ—¶éœ€è¦æ›´æ–°içš„å€¼ï¼Œç”±äºå‰è¾¹è¿ç®—å·²ç»æ£€æµ‹è¿™ä¸ªå€¼ç­‰äºpï¼Œæ‰€ä»¥ä¸éœ€è¦å†æ£€æµ‹ä¸€æ¬¡i
                i++;
            } else {
                i++;
            }
        }
        Community.swap(arr, l, lt);

        quickSort3Ways(arr, l, lt - 1);
        quickSort3Ways(arr, gt, r);
```

## å½’å¹¶æ’åºâ€”â€”é“æµæˆé’ˆ

æ ¸å¿ƒæ€æƒ³ï¼š

- å…ˆè§£å†³å°é—®é¢˜ï¼Œä¸€ç‚¹ä¸€ç‚¹è§£å†³å¤§é—®é¢˜
- æ¯æ¬¡éƒ½æ˜¯äºŒåˆ†â€”â€”è¿™ä¸ªèˆ’æœ

```java
public void mergeSort(Integer[] arr) {
        int n = arr.length;
        mergeSort(arr, 0, n - 1);
    }

    private void mergeSort(Integer[] arr, int l, int r) {
        if (r - l <= 15) {
            new InsertSort().insertSortOptimization(arr);
            return;
        }
        /*æ‰¾åˆ°ä¸­é—´ç‚¹mid*/
        int mid = l + (r - l) / 2;
        mergeSort(arr, l, mid);
        mergeSort(arr, mid + 1, r);
        merge(arr, l, mid, r);
    }

    /**
     * @param arr arr
     * @param l   l
     * @param mid mid
     * @param r   r
     *            arr[l,mid] arr[mid+1,r]
     */
    private void merge(Integer[] arr, int l, int mid, int r) {
        Integer[] front = Arrays.copyOfRange(arr, l, mid);
        Integer[] tail = Arrays.copyOfRange(arr, mid + 1, r);
        /*front*/
        int i = 0;
        /*tail*/
        int j = 0;
        /*arr*/
        int k = l;
        while (i < front.length && j < tail.length) {
            if (front[i] >= tail[j]) {
                arr[k] = tail[j];
                j++;
            } else if (front[i] < tail[j]) {
                arr[k] = front[i];
                i++;
            }
            k++;
        }
        /*æ²¡å¼„å®Œç»§ç»­å¼„*/
        while (j < tail.length) {
            arr[k] = tail[j];
            k++;
            j++;
        }
        while (i < front.length) {
            arr[k] = front[i];
            k++;
            i++;
        }
    }
```



### ä¼˜åŒ–

- å¯¹è¿‘ä¹æœ‰åºçš„æ•°ç»„æ•ˆæœä¸å¥½
- åŸå› ï¼šé€’å½’åˆ°ä¸¤ä¸ªå­éƒ¨åˆ†åï¼Œä¸ç®¡ä»–ä»¬æ˜¯å¦æœ‰åºéƒ½ä¼šè¿›è¡Œmergeæ“çºµ
- æ”¹è¿›æ€è·¯ï¼šå¯ä»¥åˆ¤æ–­ä¸€ä¸‹midå’Œmid+1ï¼Œè‹¥ä»–ä»¬ä¿©æ˜¯æœ‰åºçš„ä¸éœ€è¦mergeäº†ï¼ŒhiahiahiağŸ‘€

```java
private void mergeSort(Integer[] arr, int l, int r) {
        if (r - l <= 15) {
            new InsertSort().insertSortOptimization(arr);
            return;
        }
        /*æ‰¾åˆ°ä¸­é—´ç‚¹mid*/
        int mid = l + (r - l) / 2;
        mergeSort(arr, l, mid);
        mergeSort(arr, mid + 1, r);
        if (arr[mid] > arr[mid + 1]) {
            merge(arr, l, mid, r);
        }
    }
```

### è‡ªåº•å‘ä¸Šçš„å½’å¹¶æ’åº

- ä¸ç”¨é€’å½’
- ä¸éœ€è¦ç´¢å¼•
- å°±æ˜¯è¿™ä¹ˆç‰›é€¼

```java
/*å®šä¹‰æœ€å°çš„å½’å¹¶å°ºå¯¸SZ*/
        for (int sz = 1; sz < n; sz += sz) {
            /*iè¡¨ç¤ºæ¯ä¸€è½®å½’å¹¶çš„èµ·å§‹ä½ç½®*/
            for (int i = 0; i < n-sz; i += sz + sz) {
                /*i<n-sz:ç¡®ä¿i+szå­˜åœ¨æ‰mergeï¼Œå¦åˆ™ä¸éœ€è¦merge*/
                /*[i,i+sz-1] [i+sz,i+sz+sz-1]*/
                if(arr[i+sz-1]>arr[i+sz]){
                    /*éœ€è¦merge*/
                    mergeBu(arr,i,i+sz-1,Math.min(i+sz+sz-1,n-1));
                }
            }

        }
```

## å †æ’åºâ€”â€”ä¸€ä¸ªä¸å¤ªç†Ÿä½†å¾ˆç‰›é€¼çš„æ’åº

å †ç»“æ„ç‰¹æ€§å¦‚ä¸‹ï¼š

- å±‚çº§åˆ†æ˜çš„å¤§å°å…³ç³»
- å¯ä»¥ç”¨æ•°ç»„è¡¨ç¤º

![image-20200307104027246](https://tva1.sinaimg.cn/large/00831rSTly1gcl6pqjtfaj31090gyjts.jpg)

ä¸Šä»£ç ï¼š

```java
public void heapSort(Integer[] arr) {
        int n = arr.length;
        heapify(arr);
        int j = n - 1;
        while (j >= 1) {
            /*æ‹¿å‡ºæœ€ä¸Šæ–¹çš„å€¼ï¼ˆæœ€å¤§å€¼ï¼‰
             * ä¸æœ€åçš„å€¼äº¤æ¢ä½ç½®ï¼ˆç†åº”æ”¾åˆ°æœ€åï¼‰*/
            Community.swap(arr, j, 0);
            /*è¾¹ç•Œ[0,j-1],jä¸ªå…ƒç´ 
             * æ•´ç†æˆå †*/
            siftDown(arr, 0, j);
            /*èµ°ä¸‹ä¸€ä¸ªj*/
            j--;
        }
    }

    private void heapify(Integer[] arr) {
        int n = arr.length;
        for (int i = parent(n - 1); i >= 0; i--) {
            /*ä»æœ‰å­èŠ‚ç‚¹çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹ï¼Œ
            * ç”±ä¸‹å¾€ä¸Šsiftdown*/
            siftDown(arr, i, n);
        }
    }

    private int parent(int i) {
        return (i - 1) / 2;
    }

    private void siftDown(Integer[] arr, int i, int n) {
        /*æœ‰å·¦å­©å­æ—¶ä¼šè€ƒè™‘siftdownæ“ä½œ*/
        while (leftChild(i) < n) {
            int j = leftChild(i);
            /*æ‰¾åˆ°æœ€å¤§çš„å­èŠ‚ç‚¹*/
            if (j + 1 < n && arr[j] < arr[j + 1]) {
                j += 1;
            }
            if (arr[j] < arr[i]) {
                break;
            }
            /*ä¸‹æ²‰*/
            Community.swap(arr, j, i);
            /*æ›´æ–°iï¼Œæ£€æŸ¥ä¸‹ä¸€æ¬¡ä¸‹æ²‰æƒ…å†µ*/
            i = j;
        }
    }

    private int leftChild(int i) {
        return 2 * i + 1;
    }
```

### äºŒå‰å †

### ç´¢å¼•å †